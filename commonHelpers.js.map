{"version":3,"file":"commonHelpers.js","sources":["../src/img/x-octagon.svg","../src/main.js"],"sourcesContent":["export default \"__VITE_ASSET__655c9695__\"","import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport axios from 'axios';\nimport icon from './img/x-octagon.svg';\n\nconst userInput = document.querySelector('.data-select');\nconst userList = document.querySelector('.gallery-list');\nconst activeLoader = document.querySelector('.loader');\nconst loadMoreBtn = document.querySelector('.load-more');\nconst endMessage = document.querySelector('.end-message');\n\nconst PIXABAY_API_KEY = '42133778-4b8d89235d578f5a93c0f41d5';\n\nconst lightbox = new SimpleLightbox('.gallery-list a', {\n  captionsData: 'alt',\n  captionDelay: 250,\n});\n\nlet currentPage = 1;\nlet currentQuery = '';\nconst perPage = 15;\nlet totalHits = 0;\n\nuserInput.addEventListener('submit', async (e) => {\n  e.preventDefault();\n  const userInputValue = userInput.elements.request.value.trim();\n  currentQuery = userInputValue;\n\n  if (!userInputValue) {\n    return;\n  }\n\n  currentPage = 1;\n  userList.innerHTML = '';\n  activeLoader.classList.toggle('loader-active');\n\n  try {\n    const data = await fetchGallery(currentQuery, currentPage);\n    totalHits = data.totalHits;\n\n    if (data.totalHits > 0) {\n      renderGallery(data);\n\n      if (data.hits.length < perPage) {\n        showEndMessage();\n      } else {\n        showErrorToast('Sorry, there are no images matching your search query. Please try again!');\n      }\n    } else {\n      showErrorToast('Sorry, there are no images matching your search query. Please try again!');\n    }\n  } catch (error) {\n    handleFetchError(error);\n  } finally {\n    activeLoader.classList.toggle('loader-active');\n    userInput.reset();\n  }\n});\n\nasync function fetchGallery(query, page) {\n  const searchParams = {\n    key: PIXABAY_API_KEY,\n    q: query,\n    image_type: 'photo',\n    orientation: 'horizontal',\n    safesearch: true,\n    per_page: perPage,\n    page: page,\n  };\n\n  const { data } = await axios.get('https://pixabay.com/api/', { params: searchParams });\n  return data;\n}\n\nfunction renderGallery(data) {\n  const cardHeight = document.querySelector('.gallery-item').getBoundingClientRect().height;\n\n  const markup = data.hits\n    .map((hit) => {\n      return `<li class=\"gallery-item\">\n          <a class=\"gallery-link\" href=\"${hit.largeImageURL}\">\n            <img\n              class=\"gallery-image\"\n              src=\"${hit.webformatURL}\"\n              alt=\"${hit.tags}\"\n              width=\"360\"\n              height=\"200\"\n            />\n            <ul class=\"info-list\">\n              <li class=\"info-item\">\n                <h2 class=\"item-title\">Likes</h2>\n                <p class=\"item-content\">${hit.likes}</p>\n              </li>\n              <li class=\"info-item\">\n                <h2 class=\"item-title\">Views</h2>\n                <p class=\"item-content\">${hit.views}</p>\n              </li>\n              <li class=\"info-item\">\n                <h2 class=\"item-title\">Comments</h2>\n                <p class=\"item-content\">${hit.comments}</p>\n              </li>\n              <li class=\"info-item\">\n                <h2 class=\"item-title\">Downloads</h2>\n                <p class=\"item-content\">${hit.downloads}</p>\n              </li>\n            </ul>\n          </a>\n        </li>`;\n    })\n    .join('');\n\n  userList.insertAdjacentHTML('beforeend', markup);\n  lightbox.refresh();\n\n  // Плавна прокрутка до наступної групи зображень\n  window.scrollBy({\n    top: cardHeight * perPage,\n    behavior: 'smooth',\n  });\n}\n\nfunction showErrorToast(message) {\n  iziToast.error({\n    message,\n    messageColor: '#FAFAFB',\n    messageSize: '16',\n    messageLineHeight: '20',\n    position: 'topRight',\n    backgroundColor: '#EF4040',\n    iconUrl: icon,\n    icon: 'fa-regular',\n    iconColor: '#FAFAFB',\n    maxWidth: '500',\n    transitionIn: 'bounceInLeft',\n  });\n}\n\nfunction handleFetchError(error) {\n  if (error.message.includes('404')) {\n    showErrorToast('Oops! The requested resource was not found.');\n  } else if (error.message.includes('500')) {\n    showErrorToast('Oops! Something went wrong on the server. Please try again later.');\n  } else {\n    showErrorToast('Oops! An unexpected error occurred. Please try again.');\n  }\n}\n\nfunction showLoadMoreButton() {\n  loadMoreBtn.style.display = 'block';\n}\n\nfunction hideLoadMoreButton() {\n  loadMoreBtn.style.display = 'none';\n}\n\nfunction showEndMessage() {\n  endMessage.style.display = 'block';\n}\n\nloadMoreBtn.addEventListener('click', async () => {\n  currentPage++;\n\n  try {\n    const data = await fetchGallery(currentQuery, currentPage);\n\n    if (data.totalHits > 0) {\n      renderGallery(data);\n\n      if (data.hits.length < perPage) {\n        showEndMessage();\n        hideLoadMoreButton();\n      }\n    } else {\n      hideLoadMoreButton();\n    }\n  } catch (error) {\n    handleFetchError(error);\n  }\n});\n\n"],"names":["icon","userInput","userList","activeLoader","loadMoreBtn","endMessage","PIXABAY_API_KEY","lightbox","SimpleLightbox","currentPage","currentQuery","perPage","totalHits","userInputValue","data","fetchGallery","renderGallery","showEndMessage","showErrorToast","error","handleFetchError","query","page","searchParams","axios","cardHeight","markup","hit","message","iziToast","hideLoadMoreButton"],"mappings":"owBAAA,MAAeA,EAAA,+CCOTC,EAAY,SAAS,cAAc,cAAc,EACjDC,EAAW,SAAS,cAAc,eAAe,EACjDC,EAAe,SAAS,cAAc,SAAS,EAC/CC,EAAc,SAAS,cAAc,YAAY,EACjDC,EAAa,SAAS,cAAc,cAAc,EAElDC,EAAkB,qCAElBC,EAAW,IAAIC,EAAe,kBAAmB,CACrD,aAAc,MACd,aAAc,GAChB,CAAC,EAED,IAAIC,EAAc,EACdC,EAAe,GACnB,MAAMC,EAAU,GAChB,IAAIC,EAAY,EAEhBX,EAAU,iBAAiB,SAAU,MAAO,GAAM,CAChD,EAAE,eAAc,EAChB,MAAMY,EAAiBZ,EAAU,SAAS,QAAQ,MAAM,OAGxD,GAFAS,EAAeG,EAEX,EAACA,EAIL,CAAAJ,EAAc,EACdP,EAAS,UAAY,GACrBC,EAAa,UAAU,OAAO,eAAe,EAE7C,GAAI,CACF,MAAMW,EAAO,MAAMC,EAAaL,EAAcD,CAAW,EACzDG,EAAYE,EAAK,UAEbA,EAAK,UAAY,GACnBE,EAAcF,CAAI,EAEdA,EAAK,KAAK,OAASH,EACrBM,IAEAC,EAAe,0EAA0E,GAG3FA,EAAe,0EAA0E,CAE5F,OAAQC,EAAP,CACAC,EAAiBD,CAAK,CAC1B,QAAY,CACRhB,EAAa,UAAU,OAAO,eAAe,EAC7CF,EAAU,MAAK,CAChB,EACH,CAAC,EAED,eAAec,EAAaM,EAAOC,EAAM,CACvC,MAAMC,EAAe,CACnB,IAAKjB,EACL,EAAGe,EACH,WAAY,QACZ,YAAa,aACb,WAAY,GACZ,SAAUV,EACV,KAAMW,CACV,EAEQ,CAAE,KAAAR,GAAS,MAAMU,EAAM,IAAI,2BAA4B,CAAE,OAAQD,CAAY,CAAE,EACrF,OAAOT,CACT,CAEA,SAASE,EAAcF,EAAM,CAC3B,MAAMW,EAAa,SAAS,cAAc,eAAe,EAAE,sBAAuB,EAAC,OAE7EC,EAASZ,EAAK,KACjB,IAAKa,GACG;AAAA,0CAC6BA,EAAI;AAAA;AAAA;AAAA,qBAGzBA,EAAI;AAAA,qBACJA,EAAI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,0CAOiBA,EAAI;AAAA;AAAA;AAAA;AAAA,0CAIJA,EAAI;AAAA;AAAA;AAAA;AAAA,0CAIJA,EAAI;AAAA;AAAA;AAAA;AAAA,0CAIJA,EAAI;AAAA;AAAA;AAAA;AAAA,cAKzC,EACA,KAAK,EAAE,EAEVzB,EAAS,mBAAmB,YAAawB,CAAM,EAC/CnB,EAAS,QAAO,EAGhB,OAAO,SAAS,CACd,IAAKkB,EAAad,EAClB,SAAU,QACd,CAAG,CACH,CAEA,SAASO,EAAeU,EAAS,CAC/BC,EAAS,MAAM,CACb,QAAAD,EACA,aAAc,UACd,YAAa,KACb,kBAAmB,KACnB,SAAU,WACV,gBAAiB,UACjB,QAAS5B,EACT,KAAM,aACN,UAAW,UACX,SAAU,MACV,aAAc,cAClB,CAAG,CACH,CAEA,SAASoB,EAAiBD,EAAO,CAC3BA,EAAM,QAAQ,SAAS,KAAK,EAC9BD,EAAe,6CAA6C,EACnDC,EAAM,QAAQ,SAAS,KAAK,EACrCD,EAAe,mEAAmE,EAElFA,EAAe,uDAAuD,CAE1E,CAMA,SAASY,GAAqB,CAC5B1B,EAAY,MAAM,QAAU,MAC9B,CAEA,SAASa,GAAiB,CACxBZ,EAAW,MAAM,QAAU,OAC7B,CAEAD,EAAY,iBAAiB,QAAS,SAAY,CAChDK,IAEA,GAAI,CACF,MAAMK,EAAO,MAAMC,EAAaL,EAAcD,CAAW,EAErDK,EAAK,UAAY,GACnBE,EAAcF,CAAI,EAEdA,EAAK,KAAK,OAASH,IACrBM,IACAa,MAGFA,GAEH,OAAQX,EAAP,CACAC,EAAiBD,CAAK,CACvB,CACH,CAAC"}